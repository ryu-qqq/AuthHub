# AUT-001: Domain Layer êµ¬í˜„

**Epic**: B2B AuthHub - ë©€í‹° í…Œë„ŒíŠ¸ ì¸ì¦/ì¸ê°€ ì‹œìŠ¤í…œ
**Issue Key**: AUT-001
**Layer**: Domain Layer
**Branch**: `feature/AUT-001-user-registration`
**Jira Epic**: [AUT-73](https://ryuqqq.atlassian.net/browse/AUT-73)
**Jira Issue**: [AUT-74](https://ryuqqq.atlassian.net/browse/AUT-74)
**Status**: In Progress
**Started**: 2025-12-02
**Assignee**: ë¥˜ìƒ

---

## ğŸ“‹ Purpose

B2B AuthHubì˜ í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ê³¼ ë„ë©”ì¸ ê·œì¹™ì„ êµ¬í˜„í•˜ëŠ” Domain Layerë¥¼ TDDë¡œ ê°œë°œí•©ë‹ˆë‹¤.

**í•µì‹¬ ì›ì¹™**:
- DDD Aggregate Root ì¤‘ì‹¬ ì„¤ê³„
- Law of Demeter ì—„ê²© ì¤€ìˆ˜
- Tell Don't Ask íŒ¨í„´ ê°•ì œ
- Lombok ì ˆëŒ€ ê¸ˆì§€

---

## ğŸ¯ Requirements

### 1. Domain Aggregates (7ê°œ)

#### 1.1 Tenant Aggregate
```java
// aggregate/Tenant.java
public class Tenant {
    private final UUID id;
    private TenantName name;
    private TenantStatus status; // ACTIVE, SUSPENDED, DELETED
    private TenantConfig config;
    private final LocalDateTime createdAt;
    private LocalDateTime updatedAt;
    private LocalDateTime deletedAt;

    // ìƒì„±ì: ë¶ˆë³€ì„± ë³´ì¥
    public Tenant(UUID id, TenantName name, TenantConfig config) {
        this.id = requireNonNull(id);
        this.name = requireNonNull(name);
        this.config = requireNonNull(config);
        this.status = TenantStatus.ACTIVE;
        this.createdAt = LocalDateTime.now();
        this.updatedAt = this.createdAt;
    }

    // ë¹„ì¦ˆë‹ˆìŠ¤ ë©”ì„œë“œ: Tell Don't Ask
    public void suspend(String reason) {
        if (this.status == TenantStatus.DELETED) {
            throw new TenantAlreadyDeletedException(this.id);
        }
        this.status = TenantStatus.SUSPENDED;
        this.updatedAt = LocalDateTime.now();
    }

    public void activate() {
        if (this.status == TenantStatus.DELETED) {
            throw new TenantAlreadyDeletedException(this.id);
        }
        this.status = TenantStatus.ACTIVE;
        this.updatedAt = LocalDateTime.now();
    }

    public void markAsDeleted() {
        this.status = TenantStatus.DELETED;
        this.deletedAt = LocalDateTime.now();
        this.updatedAt = this.deletedAt;
    }

    public boolean isActive() {
        return this.status == TenantStatus.ACTIVE && this.deletedAt == null;
    }

    public boolean canLogin() {
        return this.status == TenantStatus.ACTIVE && this.deletedAt == null;
    }
}
```

**í•„ìˆ˜ VO**:
- `TenantName`: 2-100ì, ì˜ë¬¸/í•œê¸€/ìˆ«ì
- `TenantConfig`: `mfaRequired`, `tokenExpiryMinutes`, `refreshTokenExpiryDays`, `maxRefreshTokensPerUser`

**ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™**:
1. SUSPENDED ìƒíƒœì—ì„œëŠ” ë¡œê·¸ì¸ ë¶ˆê°€
2. DELETED ìƒíƒœì—ì„œëŠ” ë³µêµ¬ ë¶ˆê°€
3. Tenant ì‚­ì œëŠ” Soft Delete (deletedAt ì„¤ì •)

#### 1.2 Organization Aggregate
```java
// aggregate/Organization.java
public class Organization {
    private final UUID id;
    private final UUID tenantId; // Long FK ì „ëµ
    private OrganizationName name;
    private OrganizationStatus status; // ACTIVE, INACTIVE, DELETED
    private final LocalDateTime createdAt;
    private LocalDateTime updatedAt;
    private LocalDateTime deletedAt;

    public void deactivate(String reason) {
        if (this.status == OrganizationStatus.DELETED) {
            throw new OrganizationAlreadyDeletedException(this.id);
        }
        this.status = OrganizationStatus.INACTIVE;
        this.updatedAt = LocalDateTime.now();
    }

    public void markAsDeleted() {
        // ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™: í•˜ìœ„ ì‚¬ìš©ì ì¡´ì¬ ì—¬ë¶€ëŠ” Application Layerì—ì„œ ê²€ì¦
        this.status = OrganizationStatus.DELETED;
        this.deletedAt = LocalDateTime.now();
        this.updatedAt = this.deletedAt;
    }

    public boolean isActive() {
        return this.status == OrganizationStatus.ACTIVE && this.deletedAt == null;
    }
}
```

**í•„ìˆ˜ VO**:
- `OrganizationName`: 2-200ì

**ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™**:
1. INACTIVE ìƒíƒœì—ì„œëŠ” ë¡œê·¸ì¸ ì°¨ë‹¨
2. í•˜ìœ„ ì‚¬ìš©ì ì¡´ì¬ ì‹œ ì‚­ì œ ê¸ˆì§€ (Application Layerì—ì„œ ê²€ì¦)
3. DELETED ìƒíƒœì—ì„œëŠ” ë³µêµ¬ ë¶ˆê°€

#### 1.3 User Aggregate
```java
// aggregate/User.java
public class User {
    private final UUID id;
    private final UUID tenantId;
    private final UUID organizationId;
    private Username username;
    private Email email;
    private Password password;
    private UserType userType; // INTERNALë§Œ ì‚¬ìš© (PUBLIC ë¯¸ì‚¬ìš©)
    private UserStatus status; // ACTIVE, INACTIVE, SUSPENDED, DELETED
    private PhoneNumber phoneNumber;
    private final LocalDateTime createdAt;
    private LocalDateTime updatedAt;
    private LocalDateTime deletedAt;

    public void changePassword(Password oldPassword, Password newPassword) {
        if (!this.password.matches(oldPassword)) {
            throw new InvalidPasswordException();
        }
        this.password = newPassword;
        this.updatedAt = LocalDateTime.now();
    }

    public void suspend(String reason) {
        if (this.status == UserStatus.DELETED) {
            throw new UserAlreadyDeletedException(this.id);
        }
        this.status = UserStatus.SUSPENDED;
        this.updatedAt = LocalDateTime.now();
    }

    public void markAsDeleted() {
        this.status = UserStatus.DELETED;
        this.deletedAt = LocalDateTime.now();
        this.updatedAt = this.deletedAt;
    }

    public boolean canLogin() {
        return this.status == UserStatus.ACTIVE
            && this.deletedAt == null
            && this.userType == UserType.INTERNAL;
    }
}
```

**í•„ìˆ˜ VO**:
- `Username`: 3-50ì, ì˜ë¬¸/ìˆ«ì/ì–¸ë”ìŠ¤ì½”ì–´
- `Email`: RFC 5322 ê·œê²©
- `Password`: BCrypt í•´ì‹œ (ìµœì†Œ 8ì, ìˆ«ì+ì˜ë¬¸ í•„ìˆ˜)
- `PhoneNumber`: E.164 í¬ë§· (ì˜ˆ: +821012345678)

**ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™**:
1. í•œ UserëŠ” í•œ Tenant, í•œ Organizationë§Œ ì†Œì†
2. userTypeì€ INTERNALë§Œ ì§€ì› (PUBLIC ë¯¸ì‚¬ìš©)
3. SUSPENDED ìƒíƒœì—ì„œëŠ” ë¡œê·¸ì¸ ë¶ˆê°€
4. ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì‹œ ì´ì „ ë¹„ë°€ë²ˆí˜¸ ê²€ì¦ í•„ìˆ˜

#### 1.4 Role Aggregate
```java
// aggregate/Role.java
public class Role {
    private final UUID id;
    private final UUID tenantId; // nullì´ë©´ SYSTEM Role
    private RoleCode code;
    private RoleName name;
    private RoleScope scope; // SYSTEM, TENANT, ORGANIZATION
    private final LocalDateTime createdAt;
    private LocalDateTime updatedAt;
    private LocalDateTime deletedAt;

    public boolean isSystemRole() {
        return this.tenantId == null && this.scope == RoleScope.SYSTEM;
    }

    public boolean isTenantRole() {
        return this.tenantId != null && this.scope == RoleScope.TENANT;
    }

    public boolean isOrganizationRole() {
        return this.scope == RoleScope.ORGANIZATION;
    }
}
```

**í•„ìˆ˜ VO**:
- `RoleCode`: ëŒ€ë¬¸ì, ì–¸ë”ìŠ¤ì½”ì–´ (ì˜ˆ: SYSTEM_ADMIN, ORG_ADMIN)
- `RoleName`: ì—­í•  í‘œì‹œëª…
- `RoleScope`: SYSTEM, TENANT, ORGANIZATION

**ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™**:
1. SYSTEM Roleì€ tenantIdê°€ null
2. TENANT/ORGANIZATION Roleì€ tenantId í•„ìˆ˜
3. ê³„ì¸µ êµ¬ì¡° ì—†ìŒ (Flat RBAC)

#### 1.5 Permission Aggregate
```java
// aggregate/Permission.java
public class Permission {
    private final UUID id;
    private final UUID roleId; // Long FK ì „ëµ
    private Resource resource; // USER, ORGANIZATION, ROLE, TENANT
    private Action action; // CREATE, READ, UPDATE, DELETE
    private final LocalDateTime createdAt;

    public boolean allows(Resource targetResource, Action targetAction) {
        return this.resource == targetResource && this.action == targetAction;
    }
}
```

**í•„ìˆ˜ VO**:
- `Resource`: USER, ORGANIZATION, ROLE, PERMISSION, TENANT
- `Action`: CREATE, READ, UPDATE, DELETE

#### 1.6 RefreshToken Aggregate
```java
// aggregate/RefreshToken.java
public class RefreshToken {
    private final UUID id;
    private final UUID userId;
    private final String tokenHash; // SHA-256
    private final LocalDateTime issuedAt;
    private final LocalDateTime expiresAt;
    private boolean revoked;
    private LocalDateTime revokedAt;

    public void revoke() {
        if (this.revoked) {
            throw new TokenAlreadyRevokedException(this.id);
        }
        this.revoked = true;
        this.revokedAt = LocalDateTime.now();
    }

    public boolean isValid() {
        return !this.revoked
            && LocalDateTime.now().isBefore(this.expiresAt);
    }

    public boolean isExpired() {
        return LocalDateTime.now().isAfter(this.expiresAt);
    }
}
```

**ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™**:
1. 1 User ìµœëŒ€ 5ê°œ RefreshToken (ë‹¤ì¤‘ ê¸°ê¸° ì§€ì›)
2. RTR (Refresh Token Rotation): ì¬ë°œê¸‰ ì‹œ ê¸°ì¡´ í† í° ë¬´íš¨í™”
3. Token ì €ì¥ ì‹œ SHA-256 í•´ì‹œ ì €ì¥

#### 1.7 AuditLog Aggregate
```java
// aggregate/AuditLog.java
public class AuditLog {
    private final UUID id;
    private final UUID userId;
    private final UUID tenantId;
    private final AuditAction action;
    private final AuditResource resource;
    private final UUID resourceId;
    private final String details; // JSON
    private final String ipAddress;
    private final String userAgent;
    private final LocalDateTime createdAt;
}
```

**í•„ìˆ˜ VO**:
- `AuditAction`: LOGIN, LOGOUT, CREATE, UPDATE, DELETE, PERMISSION_CHANGE
- `AuditResource`: USER, ORGANIZATION, ROLE, PERMISSION, TENANT

---

### 2. Domain Exceptions (12ê°œ)

```java
// exception/UserErrorCode.java
public enum UserErrorCode {
    USER_NOT_FOUND("U001", "ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"),
    USER_ALREADY_EXISTS("U002", "ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì‚¬ìš©ìì…ë‹ˆë‹¤"),
    USER_SUSPENDED("U003", "ì •ì§€ëœ ì‚¬ìš©ìì…ë‹ˆë‹¤"),
    USER_DELETED("U004", "ì‚­ì œëœ ì‚¬ìš©ìì…ë‹ˆë‹¤"),
    INVALID_PASSWORD("U005", "ì˜ëª»ëœ ë¹„ë°€ë²ˆí˜¸ì…ë‹ˆë‹¤"),
    DUPLICATE_USERNAME("U006", "ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì‚¬ìš©ìëª…ì…ë‹ˆë‹¤"),
    DUPLICATE_EMAIL("U007", "ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì´ë©”ì¼ì…ë‹ˆë‹¤");
}

// exception/TenantErrorCode.java
public enum TenantErrorCode {
    TENANT_NOT_FOUND("T001", "í…Œë„ŒíŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"),
    TENANT_SUSPENDED("T002", "ì •ì§€ëœ í…Œë„ŒíŠ¸ì…ë‹ˆë‹¤"),
    TENANT_DELETED("T003", "ì‚­ì œëœ í…Œë„ŒíŠ¸ì…ë‹ˆë‹¤");
}

// exception/OrganizationErrorCode.java
public enum OrganizationErrorCode {
    ORGANIZATION_NOT_FOUND("O001", "ì¡°ì§ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"),
    ORGANIZATION_HAS_USERS("O002", "í•˜ìœ„ ì‚¬ìš©ìê°€ ì¡´ì¬í•˜ì—¬ ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"),
    ORGANIZATION_DELETED("O003", "ì‚­ì œëœ ì¡°ì§ì…ë‹ˆë‹¤");
}

// exception/RoleErrorCode.java
public enum RoleErrorCode {
    ROLE_NOT_FOUND("R001", "ì—­í• ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"),
    DUPLICATE_ROLE_CODE("R002", "ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì—­í•  ì½”ë“œì…ë‹ˆë‹¤");
}
```

**ì˜ˆì™¸ í´ë˜ìŠ¤ êµ¬ì¡°**:
```java
public class DomainException extends RuntimeException {
    private final String errorCode;
    private final String message;

    public DomainException(String errorCode, String message) {
        super(message);
        this.errorCode = errorCode;
        this.message = message;
    }
}

public class UserNotFoundException extends DomainException {
    public UserNotFoundException(UUID userId) {
        super(
            UserErrorCode.USER_NOT_FOUND.getCode(),
            UserErrorCode.USER_NOT_FOUND.getMessage() + ": " + userId
        );
    }
}
```

---

## âœ… Zero-Tolerance Rules Checklist

### Domain Layer í•„ìˆ˜ ê·œì¹™

- [ ] **Lombok ì ˆëŒ€ ê¸ˆì§€**: Plain Javaë§Œ ì‚¬ìš©
- [ ] **Law of Demeter**: Getter ì²´ì´ë‹ ê¸ˆì§€ (`order.getCustomer().getAddress()` âŒ)
- [ ] **Tell Don't Ask**: ìƒíƒœ ì¡°íšŒ í›„ ì™¸ë¶€ì—ì„œ ë¡œì§ ì‹¤í–‰ ê¸ˆì§€
- [ ] **ë¶ˆë³€ ê°ì²´**: VOëŠ” ëª¨ë‘ ë¶ˆë³€ (final í•„ë“œ, setter ì—†ìŒ)
- [ ] **ìƒì„±ì ê²€ì¦**: VO ìƒì„± ì‹œ ìœ íš¨ì„± ê²€ì¦ í•„ìˆ˜
- [ ] **Aggregate Root**: ì™¸ë¶€ì—ì„œ ë‚´ë¶€ ì—”í‹°í‹° ì§ì ‘ ì ‘ê·¼ ê¸ˆì§€
- [ ] **Long FK ì „ëµ**: UUID í•„ë“œë§Œ ì‚¬ìš©, JPA ê´€ê³„ ì–´ë…¸í…Œì´ì…˜ ê¸ˆì§€
- [ ] **ë„ë©”ì¸ ì´ë²¤íŠ¸**: ì¤‘ìš”í•œ ìƒíƒœ ë³€ê²½ ì‹œ ì´ë²¤íŠ¸ ë°œí–‰ (v1ì—ì„œëŠ” ì„ íƒ)

### ê¸ˆì§€ëœ íŒ¨í„´ ì˜ˆì‹œ

âŒ **ì˜ëª»ëœ ì˜ˆ (Lombok)**:
```java
@Getter
@Setter
@AllArgsConstructor
public class User {
    private UUID id;
    private String username;
}
```

âœ… **ì˜¬ë°”ë¥¸ ì˜ˆ**:
```java
public class User {
    private final UUID id;
    private Username username;

    public User(UUID id, Username username) {
        this.id = requireNonNull(id);
        this.username = requireNonNull(username);
    }

    public UUID id() { return this.id; }
    public Username username() { return this.username; }
}
```

âŒ **ì˜ëª»ëœ ì˜ˆ (Law of Demeter ìœ„ë°˜)**:
```java
String city = user.getOrganization().getTenant().getAddress().getCity();
```

âœ… **ì˜¬ë°”ë¥¸ ì˜ˆ**:
```java
// User Aggregateì— ë©”ì„œë“œ ì¶”ê°€
public String tenantCity() {
    return this.organization.tenantCity();
}
```

âŒ **ì˜ëª»ëœ ì˜ˆ (Tell Don't Ask ìœ„ë°˜)**:
```java
if (user.getStatus() == UserStatus.ACTIVE) {
    user.setStatus(UserStatus.SUSPENDED);
}
```

âœ… **ì˜¬ë°”ë¥¸ ì˜ˆ**:
```java
user.suspend("ê´€ë¦¬ì ìš”ì²­");
```

---

## ğŸ§ª Test Rules

### 1. Test íŒŒì¼ ìœ„ì¹˜
```
domain/src/test/java/com/ryuqq/authhub/domain/
â”œâ”€â”€ aggregate/
â”‚   â”œâ”€â”€ TenantTest.java
â”‚   â”œâ”€â”€ OrganizationTest.java
â”‚   â”œâ”€â”€ UserTest.java
â”‚   â”œâ”€â”€ RoleTest.java
â”‚   â”œâ”€â”€ PermissionTest.java
â”‚   â”œâ”€â”€ RefreshTokenTest.java
â”‚   â””â”€â”€ AuditLogTest.java
â”œâ”€â”€ vo/
â”‚   â”œâ”€â”€ TenantNameTest.java
â”‚   â”œâ”€â”€ EmailTest.java
â”‚   â”œâ”€â”€ PasswordTest.java
â”‚   â”œâ”€â”€ PhoneNumberTest.java
â”‚   â””â”€â”€ ...
â””â”€â”€ exception/
    â”œâ”€â”€ UserNotFoundExceptionTest.java
    â””â”€â”€ ...
```

### 2. Test ì‘ì„± ê·œì¹™

**Aggregate í…ŒìŠ¤íŠ¸**:
```java
@DisplayName("User Aggregate í…ŒìŠ¤íŠ¸")
class UserTest {

    @Test
    @DisplayName("ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì„±ê³µ")
    void changePassword_Success() {
        // Given
        Password oldPassword = Password.of("OldPass123");
        Password newPassword = Password.of("NewPass456");
        User user = UserFixture.createWithPassword(oldPassword);

        // When
        user.changePassword(oldPassword, newPassword);

        // Then
        assertThat(user.password()).isEqualTo(newPassword);
    }

    @Test
    @DisplayName("ì˜ëª»ëœ ì´ì „ ë¹„ë°€ë²ˆí˜¸ë¡œ ë³€ê²½ ì‹¤íŒ¨")
    void changePassword_InvalidOldPassword_ThrowsException() {
        // Given
        Password oldPassword = Password.of("OldPass123");
        Password wrongPassword = Password.of("WrongPass000");
        Password newPassword = Password.of("NewPass456");
        User user = UserFixture.createWithPassword(oldPassword);

        // When & Then
        assertThatThrownBy(() -> user.changePassword(wrongPassword, newPassword))
            .isInstanceOf(InvalidPasswordException.class)
            .hasMessageContaining("U005");
    }
}
```

**VO í…ŒìŠ¤íŠ¸**:
```java
@DisplayName("Email VO í…ŒìŠ¤íŠ¸")
class EmailTest {

    @ParameterizedTest
    @ValueSource(strings = {
        "user@example.com",
        "test.user@sub.example.com",
        "user+tag@example.co.kr"
    })
    @DisplayName("ìœ íš¨í•œ ì´ë©”ì¼ ìƒì„± ì„±ê³µ")
    void of_ValidEmail_Success(String validEmail) {
        // When
        Email email = Email.of(validEmail);

        // Then
        assertThat(email.value()).isEqualTo(validEmail);
    }

    @ParameterizedTest
    @ValueSource(strings = {
        "invalid",
        "@example.com",
        "user@",
        "user @example.com"
    })
    @DisplayName("ì˜ëª»ëœ ì´ë©”ì¼ í˜•ì‹ìœ¼ë¡œ ìƒì„± ì‹¤íŒ¨")
    void of_InvalidEmail_ThrowsException(String invalidEmail) {
        // When & Then
        assertThatThrownBy(() -> Email.of(invalidEmail))
            .isInstanceOf(InvalidEmailFormatException.class);
    }
}
```

### 3. Test Coverage ëª©í‘œ
- **Aggregate**: 100% (ëª¨ë“  ë¹„ì¦ˆë‹ˆìŠ¤ ë©”ì„œë“œ)
- **VO**: 100% (ìƒì„±ì ê²€ì¦ ë¡œì§)
- **Exception**: 100% (ë©”ì‹œì§€ ê²€ì¦)

---

## ğŸ¯ Completion Criteria

### 1. êµ¬í˜„ ì™„ë£Œ ì¡°ê±´
- [ ] 7ê°œ Aggregate ëª¨ë‘ êµ¬í˜„ ì™„ë£Œ
- [ ] 12ê°œ VO ëª¨ë‘ êµ¬í˜„ ë° í…ŒìŠ¤íŠ¸ ì™„ë£Œ
- [ ] 12ê°œ Domain Exception ëª¨ë‘ êµ¬í˜„ ì™„ë£Œ
- [ ] ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼ (Unit Test 100%)
- [ ] ArchUnit ê²€ì¦ í†µê³¼

### 2. ArchUnit ê²€ì¦ í•­ëª©
```java
@ArchTest
static final ArchRule domain_should_not_depend_on_other_layers =
    noClasses()
        .that().resideInAPackage("..domain..")
        .should().dependOnClassesThat()
        .resideInAnyPackage("..application..", "..adapter..");

@ArchTest
static final ArchRule aggregates_should_not_use_lombok =
    noClasses()
        .that().resideInAPackage("..domain.aggregate..")
        .should().beAnnotatedWith(Getter.class)
        .orShould().beAnnotatedWith(Setter.class);

@ArchTest
static final ArchRule value_objects_should_be_immutable =
    classes()
        .that().resideInAPackage("..domain.vo..")
        .should().haveOnlyFinalFields();
```

### 3. Code Review Checklist
- [ ] Law of Demeter ì¤€ìˆ˜ í™•ì¸
- [ ] Tell Don't Ask íŒ¨í„´ ì ìš© í™•ì¸
- [ ] VO ë¶ˆë³€ì„± í™•ì¸
- [ ] Aggregate Root ê²½ê³„ í™•ì¸
- [ ] Long FK ì „ëµ ì¤€ìˆ˜ í™•ì¸

---

## ğŸ“š Related Documents

- [Domain Layer Guide](../../docs/coding_convention/02-domain-layer/domain-guide.md)
- [Aggregate Test Guide](../../docs/coding_convention/02-domain-layer/aggregate/aggregate-test-guide.md)
- [VO Guide](../../docs/coding_convention/02-domain-layer/vo/vo-guide.md)
- [PRD: B2B AuthHub](../b2b-auth-hub.md)

---

## ğŸ”„ Kent Beck TDD Commands

```bash
# Domain Layer TDD ì‚¬ì´í´ ì‹¤í–‰
/kb/domain/go          # Plan íŒŒì¼ ê¸°ë°˜ ë‹¤ìŒ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
/kb/domain/red         # Red: test: ì»¤ë°‹
/kb/domain/green       # Green: feat: ì»¤ë°‹
/kb/domain/refactor    # Refactor: struct: ì»¤ë°‹
```
