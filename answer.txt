 ---
  ğŸ“Š ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ë¶„ì„

  í˜„ì¬ í˜¸ì¶œ íë¦„

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Client  â”‚ â”€â”€â†’ â”‚    Gateway      â”‚ â”€â”€â†’ â”‚   AuthHub    â”‚
  â”‚ (Admin   â”‚     â”‚ (Spring Cloud)  â”‚     â”‚ (Backend)    â”‚
  â”‚  Front)  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
                          â”‚ JWT ê²€ì¦ í›„ í—¤ë” ì¶”ê°€
                          â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚ X-User-Id: <user_id>       â”‚
                     â”‚ X-Tenant-Id: <tenant_id>   â”‚
                     â”‚ X-Roles: ["ADMIN","USER"]  â”‚
                     â”‚ X-Trace-Id: <uuid>         â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  AuthHub ì—­í•  ì •ë¦¬

  | êµ¬ë¶„           | ì—­í•                     | ì¸ì¦ ë°©ì‹                    |
  |--------------|-----------------------|--------------------------|
  | Internal API | Admin í™”ë©´ìš© (Gateway ë’¤) | Gatewayê°€ JWT ê²€ì¦ â†’ í—¤ë” ì‹ ë¢°  |
  | Open API     | ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ë™             | API Key + Secret (ì§ì ‘ ê²€ì¦) |
  | Auth API     | JWKS, Token Refresh   | ê³µê°œ / Refresh Token           |

  ---
  ğŸ¯ API ì¸ì¦ ë°©ì‹ ì œì•ˆ

  ì¶”ì²œ: í•˜ì´ë¸Œë¦¬ë“œ ë°©ì‹

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  API ìœ í˜•ë³„ ì¸ì¦ ì „ëµ                                             â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                                                 â”‚
  â”‚  1ï¸âƒ£ Admin API (Internal) - Gateway ê²½ìœ                          â”‚
  â”‚     â””â”€ Gatewayì—ì„œ JWT ê²€ì¦ ì™„ë£Œ                                  â”‚
  â”‚     â””â”€ X-User-Id, X-Tenant-Id, X-Roles í—¤ë” ì‹ ë¢°                 â”‚
  â”‚     â””â”€ AuthHubëŠ” í—¤ë” ê¸°ë°˜ ê¶Œí•œ ì²´í¬ë§Œ                             â”‚
  â”‚                                                                 â”‚
  â”‚  2ï¸âƒ£ Open API (External) - Direct í˜¸ì¶œ                           â”‚
  â”‚     â””â”€ API Key + Secret (HMAC ì„œëª…)                             â”‚
  â”‚     â””â”€ API Keyë¡œ Tenant/Organization ì‹ë³„                        â”‚
  â”‚     â””â”€ Rate Limiting per API Key                                â”‚
  â”‚     â””â”€ ìš©ë„: SDK, íŒŒíŠ¸ë„ˆ ì—°ë™, ì™¸ë¶€ ì‹œìŠ¤í…œ                         â”‚
  â”‚                                                                 â”‚
  â”‚  3ï¸âƒ£ Auth API (Public)                                          â”‚
  â”‚     â””â”€ JWKS: ê³µê°œ (ì¸ì¦ ë¶ˆí•„ìš”)                                   â”‚
  â”‚     â””â”€ Token Refresh: Refresh Token ê²€ì¦                        â”‚
  â”‚                                                                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  API Key êµ¬ì¡° (Open APIìš©)

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  API Credential                                 â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  api_key_id: "ak_xxxxxxxxxxxxxx"               â”‚
  â”‚  api_secret: "sk_xxxxxxxxxxxxxx" (í•´ì‹œ ì €ì¥)    â”‚
  â”‚  tenant_id: 1                                  â”‚
  â”‚  organization_id: 1 (nullable)                 â”‚
  â”‚  scopes: ["user:read", "user:write"]           â”‚
  â”‚  rate_limit: 1000 req/min                      â”‚
  â”‚  expires_at: 2025-12-31                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ---
  ğŸ“‹ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ì •ë¦¬

  | ID     | ê·œì¹™          | ìƒì„¸                                                     |
  |--------|-------------|--------------------------------------------------------|
  | BR-001 | ë©€í‹°í…Œë„Œì‹œ ê²©ë¦¬    | Tenant ê°„ ë°ì´í„° ì™„ì „ ê²©ë¦¬, ëª¨ë“  ì¡°íšŒ/ìˆ˜ì • ì‹œ tenantId í•„í„° í•„ìˆ˜          |
  | BR-002 | ê³„ì¸µì  ê¶Œí•œ      | ìŠˆí¼ì–´ë“œë¯¼ > í…Œë„ŒíŠ¸ì–´ë“œë¯¼ > ì¡°ì§ì–´ë“œë¯¼ > ì¼ë°˜ìœ ì €                          |
  | BR-003 | Admin ì ‘ê·¼    | X-Roles í—¤ë”ì— SUPER_ADMIN, TENANT_ADMIN, ORG_ADMIN ì—­í•  í™•ì¸ |
  | BR-004 | Open API ì¸ì¦ | API Key + HMAC ì„œëª…, Tenant/Org ìˆ˜ì¤€ ë°œê¸‰                    |
  | BR-005 | í…Œë„ŒíŠ¸-ì¡°ì§ ê´€ê³„   | 1:N, ì¡°ì§ì€ ë°˜ë“œì‹œ í•˜ë‚˜ì˜ í…Œë„ŒíŠ¸ì— ì†í•¨                               |
  | BR-006 | ì¡°ì§-ìœ ì € ê´€ê³„    | N:M, ìœ ì €ëŠ” ì—¬ëŸ¬ ì¡°ì§ì— ì†í•  ìˆ˜ ìˆìŒ (ì¶”í›„)                           |

  ---
  ğŸ—ï¸ êµ¬í˜„ ê³„íš (Phaseë³„)

  Phase 1: í•µì‹¬ ì¸í”„ë¼ + Admin API (Internal)

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Phase 1 - ê¸°ë°˜ êµ¬ì¶• (2ì£¼ ì˜ˆìƒ)                                   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                                                 â”‚
  â”‚  1.1 ë³´ì•ˆ ì¸í”„ë¼ (Gateway ì—°ë™)                                   â”‚
  â”‚      â€¢ SecurityContext êµ¬í˜„ (X-User-Id, X-Tenant-Id íŒŒì‹±)        â”‚
  â”‚      â€¢ @TenantScope ì–´ë…¸í…Œì´ì…˜ (í…Œë„ŒíŠ¸ ê²©ë¦¬ ìë™í™”)                 â”‚
  â”‚      â€¢ @RequireRole ì–´ë…¸í…Œì´ì…˜ (ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´)                â”‚
  â”‚                                                                 â”‚
  â”‚  1.2 Tenant ì „ì²´ ì¬êµ¬í˜„                                          â”‚
  â”‚      â€¢ Domain: Tenant Aggregate (ì»¨ë²¤ì…˜ ì¤€ìˆ˜)                    â”‚
  â”‚      â€¢ Application: TenantCommandUseCase, TenantQueryUseCase    â”‚
  â”‚      â€¢ Persistence: Entity, Repository, Adapter                 â”‚
  â”‚      â€¢ REST API: CRUD + ì¡°íšŒ API                                â”‚
  â”‚                                                                 â”‚
  â”‚  1.3 Organization ì „ì²´ ì¬êµ¬í˜„                                    â”‚
  â”‚      â€¢ Domain: Organization Aggregate (ì»¨ë²¤ì…˜ ì¤€ìˆ˜)              â”‚
  â”‚      â€¢ Application: CRUD UseCase                                â”‚
  â”‚      â€¢ Persistence: Entity, Repository, Adapter                 â”‚
  â”‚      â€¢ REST API: CRUD + ì¡°íšŒ API + ê³„ì¸µ ê´€ë¦¬                     â”‚
  â”‚                                                                 â”‚
  â”‚  1.4 OpenAPI Spec ìƒì„±                                          â”‚
  â”‚      â€¢ springdoc-openapi ì„¤ì •                                   â”‚
  â”‚      â€¢ Admin API ë¬¸ì„œí™”                                         â”‚
  â”‚                                                                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Phase 2: User/Role ê´€ë¦¬ + RBAC

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Phase 2 - ê¶Œí•œ ì‹œìŠ¤í…œ (2ì£¼ ì˜ˆìƒ)                                 â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                                                 â”‚
  â”‚  2.1 User ì¬êµ¬í˜„                                                 â”‚
  â”‚      â€¢ ì¡°ì§ë³„ User ê´€ë¦¬                                          â”‚
  â”‚      â€¢ User-Organization ë§¤í•‘ (N:M)                              â”‚
  â”‚                                                                 â”‚
  â”‚  2.2 Role ì¬êµ¬í˜„                                                 â”‚
  â”‚      â€¢ Role CRUD API ì¶”ê°€                                       â”‚
  â”‚      â€¢ Permission ë„ë©”ì¸ ì¶”ê°€                                    â”‚
  â”‚      â€¢ Role-Permission ë§¤í•‘                                     â”‚
  â”‚                                                                 â”‚
  â”‚  2.3 RBAC êµ¬í˜„                                                  â”‚
  â”‚      â€¢ @RequirePermission ì–´ë…¸í…Œì´ì…˜                             â”‚
  â”‚      â€¢ Permission ìºì‹± (Redis)                                  â”‚
  â”‚                                                                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Phase 3: Open API + ê³ ë„í™”

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Phase 3 - ì™¸ë¶€ ì—°ë™ (2ì£¼ ì˜ˆìƒ)                                   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                                                 â”‚
  â”‚  3.1 API Credential ë„ë©”ì¸                                       â”‚
  â”‚      â€¢ ApiKey Aggregate ìƒì„±                                    â”‚
  â”‚      â€¢ ë°œê¸‰/íê¸°/ê°±ì‹  UseCase                                    â”‚
  â”‚                                                                 â”‚
  â”‚  3.2 Open API ì¸ì¦ í•„í„°                                          â”‚
  â”‚      â€¢ HMAC ì„œëª… ê²€ì¦                                            â”‚
  â”‚      â€¢ Rate Limiting per API Key                                â”‚
  â”‚                                                                 â”‚
  â”‚  3.3 Audit Log                                                  â”‚
  â”‚      â€¢ ëª¨ë“  ë³€ê²½ ì´ë ¥ ì €ì¥                                        â”‚
  â”‚      â€¢ ì¡°íšŒ API                                                 â”‚
  â”‚                                                                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ---
  ğŸš€ Phase 1 ìƒì„¸ êµ¬í˜„ ê³„íš

  1.1 ë³´ì•ˆ ì¸í”„ë¼ (ì‹ ê·œ)

  | ë ˆì´ì–´      | ì»´í¬ë„ŒíŠ¸                  | ì „ëµ       |
  |----------|-----------------------|----------|
  | REST API | SecurityContextFilter | ğŸ†• Doc   |
  | REST API | SecurityContext       | ğŸ†• Doc   |
  | REST API | @TenantScope          | ğŸ†• Doc   |
  | REST API | @RequireRole          | ğŸ†• Doc   |
  | Domain   | TenantId (ê³µí†µ)         | ğŸ”§ ì´ë¯¸ ì¡´ì¬ |

  1.2 Tenant BC (ì „ì²´ ì¬êµ¬í˜„)

  | ë ˆì´ì–´         | ì»´í¬ë„ŒíŠ¸                                       | ì „ëµ       |
  |-------------|--------------------------------------------|----------|
  | Domain      | Tenant, TenantId, TenantName, TenantStatus | ğŸ”§ ê¸°ì¡´ ìˆ˜ì • |
  | Application | CreateTenantUseCase, UpdateTenantUseCase   | ğŸ”§ ê¸°ì¡´ ìˆ˜ì • |
  | Application | GetTenantUseCase, ListTenantsUseCase       | ğŸ†• Doc   |
  | Persistence | TenantEntity, TenantMapper                 | ğŸ”§ ê¸°ì¡´ ìˆ˜ì • |
  | Persistence | TenantQueryRepository                      | ğŸ†• Doc   |
  | REST API    | TenantCommandController                    | ğŸ”§ ê¸°ì¡´ ìˆ˜ì • |
  | REST API    | TenantQueryController                      | ğŸ†• Doc   |

  1.3 Organization BC (ì „ì²´ ì¬êµ¬í˜„)

  | ë ˆì´ì–´         | ì»´í¬ë„ŒíŠ¸                              | ì „ëµ       |
  |-------------|-----------------------------------|----------|
  | Domain      | Organization, OrganizationId, ... | ğŸ”§ ê¸°ì¡´ ìˆ˜ì • |
  | Application | Command + Query UseCase           | ğŸ”§ + ğŸ†•  |
  | Persistence | Entity, Repository, Adapter       | ğŸ”§ + ğŸ†•  |
  | REST API    | Command + Query Controller        | ğŸ”§ + ğŸ†•  |

  ---
  â“ í™•ì¸ í•„ìš” ì‚¬í•­

  ê³„íšì„ í™•ì •í•˜ê¸° ì „ì— ëª‡ ê°€ì§€ í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤:

  1. ê¸°ì¡´ ì½”ë“œ ì²˜ë¦¬ ë°©ì‹

  ê¸°ì¡´ ì½”ë“œë¥¼ ì™„ì „íˆ ì‚­ì œ í›„ ìƒˆë¡œ ì‘ì„±í• ê¹Œìš”, ì•„ë‹ˆë©´ ì ì§„ì  ë¦¬íŒ©í† ë§í• ê¹Œìš”?

  - ì™„ì „ ì¬ì‘ì„±: ê¸°ì¡´ íŒŒì¼ ì‚­ì œ â†’ ìƒˆë¡œ ìƒì„± (ê¹”ë”í•˜ì§€ë§Œ ë¦¬ìŠ¤í¬)
  - ì ì§„ì  ë¦¬íŒ©í† ë§: ê¸°ì¡´ íŒŒì¼ ìˆ˜ì • (ì•ˆì „í•˜ì§€ë§Œ ë ˆê±°ì‹œ í”ì )

  2. Phase 1 ìš°ì„ ìˆœìœ„

  ì–´ë–¤ ìˆœì„œë¡œ ì§„í–‰í• ê¹Œìš”?

  - ë³´ì•ˆ ì¸í”„ë¼ ë¨¼ì €: SecurityContext â†’ Tenant â†’ Organization
  - ë„ë©”ì¸ ë¨¼ì €: Tenant â†’ Organization â†’ ë³´ì•ˆ ì¸í”„ë¼

  3. OpenAPI Spec ë„êµ¬

  OpenAPI ë¬¸ì„œí™” ë„êµ¬ ì„ íƒ:

  - springdoc-openapi (Spring Boot 3.x ê¶Œì¥)
  - ê¸°ì¡´ rest-api.yml ìˆ˜ë™ ê´€ë¦¬ ìœ ì§€

